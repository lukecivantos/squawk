{"filter":false,"title":"helpers.php","tooltip":"/finalproject/includes/helpers.php","undoManager":{"mark":5,"position":5,"stack":[[{"start":{"row":54,"column":4},"end":{"row":112,"column":5},"action":"remove","lines":["function lookup($symbol)","    {","        // reject symbols that start with ^","        if (preg_match(\"/^\\^/\", $symbol))","        {","            return false;","        }","","        // reject symbols that contain commas","        if (preg_match(\"/,/\", $symbol))","        {","            return false;","        }","","        // headers for proxy servers","        $headers = [","            \"Accept\" => \"*/*\",","            \"Connection\" => \"Keep-Alive\",","            \"User-Agent\" => sprintf(\"curl/%s\", curl_version()[\"version\"])","        ];","","        // open connection to Yahoo","        $context = stream_context_create([","            \"http\" => [","                \"header\" => implode(array_map(function($value, $key) { return sprintf(\"%s: %s\\r\\n\", $key, $value); }, $headers, array_keys($headers))),","                \"method\" => \"GET\"","            ]","        ]);","        $handle = @fopen(\"http://download.finance.yahoo.com/d/quotes.csv?f=snl1&s={$symbol}\", \"r\", false, $context);","        if ($handle === false)","        {","            // trigger (big, orange) error","            trigger_error(\"Could not connect to Yahoo!\", E_USER_ERROR);","            exit;","        }"," ","        // download first line of CSV file","        $data = fgetcsv($handle);","        if ($data === false || count($data) == 1)","        {","            return false;","        }","","        // close connection to Yahoo","        fclose($handle);","","        // ensure symbol was found","        if ($data[2] === \"N/A\" || $data[2] === \"0.00\")","        {","            return false;","        }","","        // return stock as an associative array","        return [","            \"symbol\" => strtoupper($data[0]),","            \"name\" => $data[1],","            \"price\" => floatval($data[2])","        ];","    }"],"id":2}],[{"start":{"row":54,"column":0},"end":{"row":54,"column":4},"action":"remove","lines":["    "],"id":3}],[{"start":{"row":53,"column":7},"end":{"row":54,"column":0},"action":"remove","lines":["",""],"id":4}],[{"start":{"row":51,"column":0},"end":{"row":53,"column":7},"action":"remove","lines":["    /**","     * Returns a stock by symbol (case-insensitively) else false if not found.","     */"],"id":5}],[{"start":{"row":50,"column":0},"end":{"row":51,"column":0},"action":"remove","lines":["",""],"id":6}],[{"start":{"row":49,"column":5},"end":{"row":50,"column":0},"action":"remove","lines":["",""],"id":7}]]},"ace":{"folds":[],"scrolltop":0,"scrollleft":0,"selection":{"start":{"row":20,"column":0},"end":{"row":20,"column":0},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":0},"timestamp":1449220805000,"hash":"7127a93189dd2ce7177b6ddc83e01eecbfbee132"}